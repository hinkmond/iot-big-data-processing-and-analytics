JSON Schema
=====
root
 |-- destination: string (nullable = true)
 |-- eventTime: string (nullable = true)
 |-- guid: string (nullable = true)
 |-- payload: struct (nullable = true)
 |    |-- data: struct (nullable = true)
 |    |    |-- bodytemperature: double (nullable = true)
 |    |    |-- heartrate: long (nullable = true)
 |    |    |-- latitude: double (nullable = true)
 |    |    |-- longitude: double (nullable = true)
 |    |-- format: string (nullable = true)


 
sql table obtained from iot messages 
+---------------+---------+----------+----------+
|bodytemperature|heartrate|  latitude| longitude|
+---------------+---------+----------+----------+
|           99.7|       83| 51.423063|-0.1217732|
|           95.3|      127|51.4703043|-0.1139714|
|           99.5|       45|51.5857046|-0.1615828|
|           95.2|       71|51.4701692|-0.1065218|
|           98.1|      103|51.4711052|-0.0795158|
|           99.4|       99| 51.493723|-0.1291572|
|           96.8|      138|51.4940439|-0.0583526|
|           95.1|      117|51.5599465|-0.1261638|
|           96.4|       89|51.4574615|-0.1306077|
|           97.8|      132|51.5186394|-0.0735708|
|           95.2|       67|51.4669427|-0.0546089|
|           95.3|       51|51.5612156|-0.1443468|
|           97.8|       64|51.4914227|-0.1815553|
|           99.8|      138|51.4298599|-0.1528678|
|           97.2|      158|51.4582562|-0.0897358|
|           97.8|       31|51.5279743|-0.0834593|
|           97.4|       85|51.4358898|-0.0718076|
|           96.0|       65|51.5213118|-0.1910513|
|           95.7|       77|51.5743545|-0.1533152|
|           95.1|      134| 51.568824| -0.083786|
|           96.0|       43|51.4798096|-0.0967304|
|           98.6|       33|51.5223061|-0.1009649|
|           98.1|       61|51.5688487|-0.1558479|
|           96.8|      144|51.4601919|-0.0583724|
|           97.9|       57|51.5128287|-0.1873392|
|           98.4|       61|51.4833623|-0.1452013|
|           97.4|       95| 51.569139|-0.1346978|
|           95.4|      118|51.5583501|-0.1537677|
|           97.0|      134|51.5074167|-0.0488625|
|           99.1|       53|51.5231744|-0.0529378|
|           98.6|      145|51.5433323|-0.0764885|
|           95.5|      143|51.4972587|-0.0516733|
|           96.0|      123|51.4278724|-0.1679372|
|           96.2|      146|51.4496368|-0.0646018|
|           96.8|      113|51.5579166|-0.1456501|
|           97.1|       32|51.4771696|-0.2112215|
|           98.8|      130|51.5281417|-0.2008812|
|           97.3|       37|51.4457858|-0.0956896|
|           99.9|       42|51.4841572| -0.208311|
|           97.5|       54|51.5857069|-0.0967408|
|           98.2|      102|51.4880886|-0.1048417|
|           97.3|      116|51.5416969|  -0.17964|
|           98.6|      103|51.4580751|-0.1014271|
|           99.1|      109|51.4606483|-0.0499069|
|           98.9|       73| 51.441153|-0.1392515|
|           97.6|      105|51.4449684| -0.062377|
|           97.3|       57|51.4630678|-0.1113284|
|           97.4|      123|51.5821659|-0.1215818|
|           98.1|       75|51.5194415|-0.0819235|
|           95.3|      126|51.5655725|-0.1829937|
|           95.2|       49|51.5440212|-0.1560724|
|           98.1|       83|51.4729612|-0.1521342|
|           99.3|      119|51.5536204|-0.0558707|
|           96.8|      127|51.4175711|-0.1352709|
|           95.8|      131|51.5024401|-0.1750765|
|           96.1|       40| 51.542031| -0.121442|
|           95.4|      144|51.4533651|-0.0913028|
|           98.0|      129|51.5226948|-0.0867382|
|           99.3|      126|51.5112996|-0.1542536|
|           96.9|      100|51.5459422|-0.1985841|
|           96.5|       83|51.5047061|-0.0443404|
|           98.7|      130|51.5680932|-0.1103438|
|           98.9|       87|51.4806008|-0.1836234|
|           95.5|       54|51.5790063|-0.1473004|
|           96.5|       76|51.5269404|-0.0638009|
|           97.0|       81|51.4767504|-0.0713917|
|           99.0|      125|51.4567693|-0.1555973|
|           97.3|      154|51.4799213|-0.0845262|
|           99.0|      130|51.4687308|-0.1073955|
|           98.1|      115|51.5569299|-0.1953414|
|           99.0|       43|51.4468473|-0.1159914|
|           97.5|      155|51.5362956|-0.2019892|
|           96.7|      123|51.4325523|-0.1581746|
|           95.1|       48| 51.557602|-0.1664569|
|           98.1|       64|51.4869663|-0.1052322|
|           96.9|      102|51.4463164|-0.0989009|
|           96.3|      112|51.4835103|-0.0826269|
|           98.0|       60|51.5329288|-0.0437382|
|           99.2|       48|51.4749564|-0.2039464|
|           97.0|       89|51.5215313|-0.1389451|
|           97.9|       43|51.4874192| -0.058964|
|           98.9|      110|51.5023285|-0.0458595|
|           97.6|      104|51.4709675| -0.161738|
|           98.2|       76|51.5503222|-0.1732936|
|           98.8|       42|51.4427453|-0.1055504|
|           96.5|      158|51.5758477|-0.1212327|
|           95.2|      119|51.5095813|-0.1233071|
|           99.7|       64|51.5377533| -0.173092|
|           98.6|       79|51.5309295|-0.1037423|
|           98.4|      134|51.5080411|-0.1280846|
|           98.5|      125|51.5463838|-0.1216607|
|           97.2|       87|51.4768299|-0.0459612|
|           97.6|      129|51.5126141|-0.0443047|
|           98.7|       73|51.5114568|-0.1002792|
|           99.0|       56| 51.538776|-0.0928872|
|           98.2|       45|51.4412474|-0.1530931|
|           95.9|       73| 51.554963|-0.1529677|
|           98.5|       74|51.5087661|-0.0432117|
|           99.1|       98|51.5030136|-0.1570366|
|           99.9|      119|51.4576351|-0.0968793|
+---------------+---------+----------+----------+

filtered out patient data with heart rate out side the range of (50~150) 
and body temperature out side the range of (97~99)
+---------------+---------+----------+----------+
|bodytemperature|heartrate|  latitude| longitude|
+---------------+---------+----------+----------+
|           97.2|      158|51.4582562|-0.0897358|
|           96.5|      158|51.5758477|-0.1212327|
|           97.5|      155|51.5362956|-0.2019892|
|           97.3|      154|51.4799213|-0.0845262|
|           96.2|      146|51.4496368|-0.0646018|
|           96.8|      144|51.4601919|-0.0583724|
|           95.4|      144|51.4533651|-0.0913028|
|           95.5|      143|51.4972587|-0.0516733|
|           99.8|      138|51.4298599|-0.1528678|
|           96.8|      138|51.4940439|-0.0583526|
|           95.1|      134| 51.568824| -0.083786|
|           95.8|      131|51.5024401|-0.1750765|
|           96.8|      127|51.4175711|-0.1352709|
|           95.3|      127|51.4703043|-0.1139714|
|           99.3|      126|51.5112996|-0.1542536|
|           95.3|      126|51.5655725|-0.1829937|
|           96.7|      123|51.4325523|-0.1581746|
|           96.0|      123|51.4278724|-0.1679372|
|           99.9|      119|51.4576351|-0.0968793|
|           99.3|      119|51.5536204|-0.0558707|
|           95.2|      119|51.5095813|-0.1233071|
|           95.4|      118|51.5583501|-0.1537677|
|           95.1|      117|51.5599465|-0.1261638|
|           96.8|      113|51.5579166|-0.1456501|
|           96.3|      112|51.4835103|-0.0826269|
|           99.1|      109|51.4606483|-0.0499069|
|           96.9|      102|51.4463164|-0.0989009|
|           96.9|      100|51.5459422|-0.1985841|
|           99.4|       99| 51.493723|-0.1291572|
|           99.1|       98|51.5030136|-0.1570366|
|           96.4|       89|51.4574615|-0.1306077|
|           99.7|       83| 51.423063|-0.1217732|
|           96.5|       83|51.5047061|-0.0443404|
|           95.7|       77|51.5743545|-0.1533152|
|           96.5|       76|51.5269404|-0.0638009|
|           95.9|       73| 51.554963|-0.1529677|
|           95.2|       71|51.4701692|-0.1065218|
|           95.2|       67|51.4669427|-0.0546089|
|           96.0|       65|51.5213118|-0.1910513|
|           99.7|       64|51.5377533| -0.173092|
|           95.5|       54|51.5790063|-0.1473004|
|           99.1|       53|51.5231744|-0.0529378|
|           95.3|       51|51.5612156|-0.1443468|
|           95.2|       49|51.5440212|-0.1560724|
|           99.2|       48|51.4749564|-0.2039464|
|           95.1|       48| 51.557602|-0.1664569|
|           99.5|       45|51.5857046|-0.1615828|
|           98.2|       45|51.4412474|-0.1530931|
|           99.0|       43|51.4468473|-0.1159914|
|           97.9|       43|51.4874192| -0.058964|
|           96.0|       43|51.4798096|-0.0967304|
|           99.9|       42|51.4841572| -0.208311|
|           98.8|       42|51.4427453|-0.1055504|
|           96.1|       40| 51.542031| -0.121442|
|           97.3|       37|51.4457858|-0.0956896|
|           98.6|       33|51.5223061|-0.1009649|
|           97.1|       32|51.4771696|-0.2112215|
|           97.8|       31|51.5279743|-0.0834593|
+---------------+---------+----------+----------+